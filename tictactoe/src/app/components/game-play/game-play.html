<div class="max-w-md mx-auto p-4">
  <div class="flex items-center justify-between mb-6">
    <a (click)="back()" class="text-slate-600 hover:text-slate-800 cursor-pointer font-medium">← Volver a partidas</a>
  </div>

  <div *ngIf="error" class="mb-4 p-3 bg-red-50 text-red-600 rounded-lg text-sm">{{ error }}</div>

  <div *ngIf="game && !error" class="bg-white rounded-2xl shadow-sm border border-slate-100 p-6">
    <p class="text-center text-slate-600 mb-2">vs {{ game.opponentUsername }}</p>
    <p class="text-center text-sm text-slate-500 mb-4">Tú eres {{ game.mySymbol }}</p>

    <!-- Tablero 3x3 -->
    <div class="grid grid-cols-3 gap-2 max-w-[240px] mx-auto mb-6">
      <button
        *ngFor="let cell of [0,1,2,3,4,5,6,7,8]; let i = index"
        type="button"
        (click)="play(i)"
        [disabled]="!canPlay(i)"
        [class.bg-slate-100]="!cellValue(i)"
        [class.bg-blue-100]="cellValue(i) === 'X'"
        [class.bg-amber-100]="cellValue(i) === 'O'"
        [class.text-blue-600]="cellValue(i) === 'X'"
        [class.text-amber-600]="cellValue(i) === 'O'"
        [class.cursor-pointer]="canPlay(i)"
        [class.cursor-not-allowed]="!canPlay(i) && game.status === 'ACTIVE'"
        [class.opacity-60]="!canPlay(i) && game.status === 'ACTIVE'"
        class="aspect-square rounded-xl text-3xl font-bold transition-all hover:ring-2 hover:ring-blue-300 disabled:hover:ring-0">
        {{ cellValue(i) }}
      </button>
    </div>

    <p class="text-center font-medium text-slate-700">{{ statusMessage() }}</p>

    <div *ngIf="game.status !== 'ACTIVE'" class="mt-4 text-center">
      <button
        (click)="back()"
        class="bg-slate-600 text-white px-4 py-2 rounded-xl hover:bg-slate-700 transition-colors">
        Volver a partidas
      </button>
    </div>
  </div>

  <app-game-chat
    *ngIf="gameId && game && game.status === 'ACTIVE'"
    [gameId]="gameId"
    [opponentUsername]="game.opponentUsername"
    [onClose]="closeChat" />
</div>
